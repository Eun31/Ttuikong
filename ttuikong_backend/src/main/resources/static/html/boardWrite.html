<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²Œì‹œê¸€ ì‘ì„± - ì»¤ë®¤ë‹ˆí‹°</title>
  <style>
    /* ê¸°ë³¸ ë¦¬ì…‹ ë° ê³µí†µ ìŠ¤íƒ€ì¼ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: #e8f5e9;  /* ì˜…ì€ ì´ˆë¡ìƒ‰ ë°°ê²½ */
      color: #333;
      line-height: 1.6;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    img {
      max-width: 100%;
    }

    button {
      cursor: pointer;
      border: none;
      background: none;
    }

    input, textarea {
      font-family: inherit;
    }

    /* ì»¨í…Œì´ë„ˆ */
    .container {
      max-width: 100%;
      margin: 0 auto;
      background-color: #e8f5e9;  /* ì˜…ì€ ì´ˆë¡ìƒ‰ ë°°ê²½ */
      min-height: 100vh;
      padding: 12px;
    }

    /* í—¤ë” ìŠ¤íƒ€ì¼ */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .back-btn {
      font-size: 20px;
      color: #2e7d32;
      padding: 4px 8px;
    }

    .header-title {
      font-size: 18px;
      font-weight: 600;
      color: #2e7d32;
    }

    .submit-btn {
      background-color: #4caf50;
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
    }

    .submit-btn:disabled {
      background-color: #bdbdbd;
      cursor: not-allowed;
    }

    /* ì‘ì„± í¼ ì¹´ë“œ */
    .write-card {
      background-color: white;
      border-radius: 20px;  /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      margin-bottom: 16px;
    }

    .form-group {
      padding: 16px;
      border-bottom: 1px solid #f0f0f0;
    }

    .form-group:last-child {
      border-bottom: none;
    }

    .form-label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #2e7d32;
    }

    .form-input {
      width: 100%;
      border: none;
      padding: 8px 0;
      font-size: 16px;
    }

    .form-input:focus {
      outline: none;
    }

    .form-textarea {
      width: 100%;
      border: none;
      padding: 8px 0;
      font-size: 15px;
      min-height: 150px;
      resize: none;
    }

    .form-textarea:focus {
      outline: none;
    }

    /* ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ */
    .image-upload {
      margin-top: 12px;
    }

    .image-placeholder {
      width: 100%;
      height: 120px;
      border: 2px dashed #e0e0e0;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #757575;
      cursor: pointer;
    }

    .image-placeholder-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .image-preview {
      position: relative;
      margin-top: 12px;
    }

    .image-preview img {
      width: 100%;
      border-radius: 12px;
      display: block;
    }

    .image-remove {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ì¹´í…Œê³ ë¦¬ ì„ íƒ */
    .category-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }

    .category-option {
      padding: 8px 12px;
      background-color: #f5f5f5;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
    }

    .category-option.active {
      background-color: #4caf50;
      color: white;
    }

    /* ìœ„ì¹˜ ì„ íƒ */
    .location-input {
      display: flex;
      align-items: center;
      margin-top: 12px;
      padding: 8px 12px;
      background-color: #f5f5f5;
      border-radius: 20px;
      color: #757575;
      cursor: pointer;
    }

    .location-icon {
      margin-right: 8px;
    }

    /* íƒœê·¸ ì…ë ¥ */
    .tag-input-container {
      display: flex;
      margin-top: 12px;
    }

    .tag-input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #e0e0e0;
      border-radius: 20px 0 0 20px;
      font-size: 14px;
    }

    .tag-input:focus {
      outline: none;
      border-color: #4caf50;
    }

    .tag-add-btn {
      background-color: #4caf50;
      color: white;
      padding: 8px 16px;
      border-radius: 0 20px 20px 0;
      font-size: 14px;
    }

    .tag-add-btn:disabled {
      background-color: #bdbdbd;
      cursor: not-allowed;
    }

    .tags-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }

    .tag {
      background-color: #e8f5e9;
      color: #2e7d32;
      padding: 4px 24px 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      position: relative;
    }

    .tag-remove {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 10px;
    }

    /* ìœ„ì¹˜ ê²€ìƒ‰ ê²°ê³¼ */
    .location-results {
      margin-top: 8px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .location-results.show {
      display: block;
    }

    .location-item {
      padding: 12px;
      border-bottom: 1px solid #f0f0f0;
      background-color: white;
      cursor: pointer;
    }

    .location-item:last-child {
      border-bottom: none;
    }

    .location-item:hover {
      background-color: #f5f5f5;
    }

    /* ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
    .icon-back::before { content: 'â†'; }
    .icon-camera::before { content: 'ğŸ“·'; }
    .icon-location::before { content: 'ğŸ“'; }
    .icon-trash::before { content: 'ğŸ—‘ï¸'; }
    .icon-close::before { content: 'Ã—'; }

    /* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
    @media (min-width: 600px) {
      .container {
        max-width: 600px;
        margin: 0 auto;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- í—¤ë” -->
    <header class="header">
      <button class="back-btn" onclick="goBack()">
        <span class="icon-back"></span>
      </button>
      <h1 class="header-title">ê²Œì‹œê¸€ ì‘ì„±</h1>
      <button class="submit-btn" id="submitBtn" onclick="submitPost()">ì™„ë£Œ</button>
    </header>

    <!-- ì‘ì„± í¼ ì¹´ë“œ -->
    <div class="write-card">
      <!-- ì œëª© ì…ë ¥ -->
      <div class="form-group">
        <input type="text" id="titleInput" class="form-input" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="100">
      </div>
      
      <!-- ë‚´ìš© ì…ë ¥ -->
      <div class="form-group">
        <textarea id="contentInput" class="form-textarea" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
        
        <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ -->
        <div class="image-upload">
          <div class="image-placeholder" id="imagePlaceholder" onclick="triggerImageUpload()">
            <span class="image-placeholder-icon icon-camera"></span>
            <span>ì‚¬ì§„ ì¶”ê°€</span>
          </div>
          <div class="image-preview" id="imagePreview" style="display: none;">
            <img id="previewImg" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
            <button class="image-remove" onclick="removeImage()">
              <span class="icon-trash"></span>
            </button>
          </div>
          <input type="file" id="imageInput" accept="image/*" style="display: none;">
        </div>
      </div>
      
      <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
      <div class="form-group">
        <div class="form-label">ì¹´í…Œê³ ë¦¬</div>
        <div class="category-options">
          <div class="category-option active" data-value="DAILY" onclick="selectCategory(this)">ì¼ìƒ</div>
          <div class="category-option" data-value="TRAVEL" onclick="selectCategory(this)">ì—¬í–‰</div>
          <div class="category-option" data-value="FOOD" onclick="selectCategory(this)">ë§›ì§‘</div>
          <div class="category-option" data-value="QUESTION" onclick="selectCategory(this)">ì§ˆë¬¸</div>
          <div class="category-option" data-value="INFO" onclick="selectCategory(this)">ì •ë³´</div>
        </div>
      </div>
      
      <!-- ìœ„ì¹˜ ì„ íƒ -->
      <div class="form-group">
        <div class="form-label">ìœ„ì¹˜</div>
        <div class="location-input" onclick="toggleLocationSearch()">
          <span class="location-icon icon-location"></span>
          <span id="selectedLocation">ìœ„ì¹˜ ì¶”ê°€</span>
        </div>
        
        <div class="location-results" id="locationResults">
          <input type="text" class="form-input" id="locationSearchInput" placeholder="ìœ„ì¹˜ ê²€ìƒ‰..." oninput="searchLocation()">
          <div class="location-item" onclick="selectLocation('í•œê°•ê³µì› ì—¬ì˜ë„')">í•œê°•ê³µì› ì—¬ì˜ë„</div>
          <div class="location-item" onclick="selectLocation('ê°•ë‚¨êµ¬ ì—­ì‚¼ë™')">ê°•ë‚¨êµ¬ ì—­ì‚¼ë™</div>
          <div class="location-item" onclick="selectLocation('ì„œìš¸ ë§ˆí¬êµ¬ í™ëŒ€ì…êµ¬')">ì„œìš¸ ë§ˆí¬êµ¬ í™ëŒ€ì…êµ¬</div>
          <div class="location-item" onclick="selectLocation('ì„œìš¸íŠ¹ë³„ì‹œ ì„±ë¶êµ¬ ì•ˆì•”ë™')">ì„œìš¸íŠ¹ë³„ì‹œ ì„±ë¶êµ¬ ì•ˆì•”ë™</div>
        </div>
      </div>
      
      <!-- íƒœê·¸ ì…ë ¥ -->
      <div class="form-group">
        <div class="form-label">íƒœê·¸</div>
        <div class="tag-input-container">
          <input type="text" id="tagInput" class="tag-input" placeholder="íƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìµœëŒ€ 5ê°œ)">
          <button class="tag-add-btn" id="tagAddBtn" onclick="addTag()">ì¶”ê°€</button>
        </div>
        
        <div class="tags-list" id="tagsList">
          <!-- íƒœê·¸ê°€ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // DOM ìš”ì†Œ
    let titleInput, contentInput, imageInput, imagePlaceholder, imagePreview, previewImg;
    let selectedLocation, locationResults, locationSearchInput, tagInput, tagAddBtn, tagsList, submitBtn;
    let selectedCategory = 'DAILY';
    let tags = [];
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
      titleInput = document.getElementById('titleInput');
      contentInput = document.getElementById('contentInput');
      imageInput = document.getElementById('imageInput');
      imagePlaceholder = document.getElementById('imagePlaceholder');
      imagePreview = document.getElementById('imagePreview');
      previewImg = document.getElementById('previewImg');
      selectedLocation = document.getElementById('selectedLocation');
      locationResults = document.getElementById('locationResults');
      locationSearchInput = document.getElementById('locationSearchInput');
      tagInput = document.getElementById('tagInput');
      tagAddBtn = document.getElementById('tagAddBtn');
      tagsList = document.getElementById('tagsList');
      submitBtn = document.getElementById('submitBtn');
      
      // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì´ë²¤íŠ¸
      imageInput.addEventListener('change', handleImageUpload);
      
      // íƒœê·¸ ì…ë ¥ ì´ë²¤íŠ¸
      tagInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          addTag();
        }
      });
      
      // íƒœê·¸ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
      tagInput.addEventListener('input', function() {
        tagAddBtn.disabled = !this.value.trim() || tags.length >= 5;
      });
      
      // í¼ ìœ íš¨ì„± ì²´í¬
      titleInput.addEventListener('input', validateForm);
      contentInput.addEventListener('input', validateForm);
      
      // ì´ˆê¸° ìœ íš¨ì„± ì²´í¬
      validateForm();
    });
    
    // í¼ ìœ íš¨ì„± ê²€ì‚¬
    function validateForm() {
      const isValid = titleInput.value.trim() && contentInput.value.trim();
      submitBtn.disabled = !isValid;
    }
    
    // ì´ë¯¸ì§€ ì—…ë¡œë“œ íŠ¸ë¦¬ê±°
    function triggerImageUpload() {
      imageInput.click();
    }
    
    // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
    function handleImageUpload() {
      const file = imageInput.files[0];
      if (file) {
        // ì´ë¯¸ì§€ íƒ€ì… í™•ì¸
        if (!file.type.match('image.*')) {
          alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
          return;
        }
        
        // ì´ë¯¸ì§€ í¬ê¸° í™•ì¸ (5MB ì œí•œ)
        if (file.size > 5 * 1024 * 1024) {
          alert('ì´ë¯¸ì§€ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
          return;
        }
        
        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
        const reader = new FileReader();
        reader.onload = function(e) {
          previewImg.src = e.target.result;
          imagePlaceholder.style.display = 'none';
          imagePreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    }
    
    // ì´ë¯¸ì§€ ì œê±°
    function removeImage() {
      imageInput.value = '';
      previewImg.src = '';
      imagePlaceholder.style.display = 'flex';
      imagePreview.style.display = 'none';
    }
    
    // ì¹´í…Œê³ ë¦¬ ì„ íƒ
    function selectCategory(el) {
      // ê¸°ì¡´ ì„ íƒ í•´ì œ
      document.querySelectorAll('.category-option').forEach(option => {
        option.classList.remove('active');
      });
      
      // ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬ ì„ íƒ
      el.classList.add('active');
      selectedCategory = el.dataset.value;
    }
    
    // ìœ„ì¹˜ ê²€ìƒ‰ í† ê¸€
    function toggleLocationSearch() {
      locationResults.classList.toggle('show');
      if (locationResults.classList.contains('show')) {
        locationSearchInput.focus();
      }
    }
    
    // ìœ„ì¹˜ ê²€ìƒ‰
    function searchLocation() {
      // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” API ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€
      console.log('ìœ„ì¹˜ ê²€ìƒ‰:', locationSearchInput.value);
    }
    
    // ìœ„ì¹˜ ì„ íƒ
    function selectLocation(location) {
      selectedLocation.textContent = location;
      locationResults.classList.remove('show');
    }
    
    // íƒœê·¸ ì¶”ê°€
    function addTag() {
      const tagText = tagInput.value.trim();
      
      if (!tagText) return;
      
      // ìµœëŒ€ 5ê°œ íƒœê·¸ ì œí•œ
      if (tags.length >= 5) {
        alert('íƒœê·¸ëŠ” ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        return;
      }
      
      // ì¤‘ë³µ íƒœê·¸ í™•ì¸
      if (tags.includes(tagText)) {
        alert('ì´ë¯¸ ì¶”ê°€ëœ íƒœê·¸ì…ë‹ˆë‹¤.');
        return;
      }
      
      // íƒœê·¸ ì¶”ê°€
      tags.push(tagText);
      
      // íƒœê·¸ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
      const tagEl = document.createElement('div');
      tagEl.className = 'tag';
      tagEl.innerHTML = `
        ${tagText}
        <span class="tag-remove icon-close" onclick="removeTag('${tagText}')"></span>
      `;
      
      // íƒœê·¸ ëª©ë¡ì— ì¶”ê°€
      tagsList.appendChild(tagEl);
      
      // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      tagInput.value = '';
      tagAddBtn.disabled = true;
      
      // íƒœê·¸ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
      tagInput.focus();
    }
    
    // íƒœê·¸ ì œê±°
    function removeTag(tagText) {
      // ë°°ì—´ì—ì„œ ì œê±°
      tags = tags.filter(tag => tag !== tagText);
      
      // DOMì—ì„œ ì œê±°
      renderTags();
    }
    
    // íƒœê·¸ ë Œë”ë§
    function renderTags() {
      // íƒœê·¸ ëª©ë¡ ì´ˆê¸°í™”
      tagsList.innerHTML = '';
      
      // íƒœê·¸ ë Œë”ë§
      tags.forEach(tag => {
        const tagEl = document.createElement('div');
        tagEl.className = 'tag';
        tagEl.innerHTML = `
          ${tag}
          <span class="tag-remove icon-close" onclick="removeTag('${tag}')"></span>
        `;
        tagsList.appendChild(tagEl);
      });
    }
    
    // ê²Œì‹œê¸€ ì œì¶œ
    function submitPost() {
      // í•„ìˆ˜ í•„ë“œ í™•ì¸
      if (!titleInput.value.trim()) {
        alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        titleInput.focus();
        return;
      }
      
      if (!contentInput.value.trim()) {
        alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        contentInput.focus();
        return;
      }
      
      // ê²Œì‹œê¸€ ë°ì´í„° ìˆ˜ì§‘
      const postData = {
        title: titleInput.value.trim(),
        content: contentInput.value.trim(),
        category: selectedCategory,
        location: selectedLocation.textContent !== 'ìœ„ì¹˜ ì¶”ê°€' ? selectedLocation.textContent : null,
        tags: tags
      };
      
      // ì´ë¯¸ì§€ ì²˜ë¦¬ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” FormData ì‚¬ìš©)
      if (imageInput.files.length > 0) {
        // ì´ë¯¸ì§€ íŒŒì¼ ì¶”ê°€ ë¡œì§
      }
      
      // ì„œë²„ì— ë°ì´í„° ì „ì†¡ (ì‹¤ì œ êµ¬í˜„)
      console.log('ì „ì†¡í•  ë°ì´í„°:', postData);
      alert('ê²Œì‹œê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      // ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™
      goBack();
    }
    
    // ë’¤ë¡œ ê°€ê¸°
    function goBack() {
      if (titleInput.value.trim() || contentInput.value.trim() || tags.length > 0 || imageInput.files.length > 0) {
        if (confirm('ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          window.location.href = 'index.html';
        }
      } else {
        window.location.href = 'index.html';
      }
    }
  </script>
</body>
</html>