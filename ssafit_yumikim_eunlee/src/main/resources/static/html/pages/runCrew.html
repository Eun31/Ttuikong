<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>ê·¸ë£¹ ìƒì„¸</title>
  <style>
    @import url('../css/runCrew.css');
  </style>
</head>

<body>

  <!-- í˜„ì¬ ëŸ¬ë‹ ì‹œê°„ -->
  <div class="timer-card">
    <h2>í˜„ì¬ ëŸ¬ë‹ ì‹œê°„</h2>
    <div class="time" id="duration">00:00</div>
    <button class="play-button" id="toggleTracking">â–¶</button>
  </div>

  <!-- ê·¸ë£¹ ë©¤ë²„ ëŸ¬ë‹ ë­í‚¹ -->
  <h3>ì„œìš¸ 8ë°˜ ëŸ¬ë‹ ì±Œë¦°ì§€</h3>
  <div class="user-list" id="crewMemberList"></div>

  <!-- ì½© ì„±ì¥ ë°” -->
  <p>ì½©ì´ ìë¼ëŠ” ì¤‘ ğŸŒ±ğŸŒ¿</p>
  <div class="progress">
    <div id="growthBar" style="width: 40%;"></div>
  </div>

  <!-- Talk ë²„íŠ¼ -->
  <h3>ì„œìš¸ 8ë°˜ ì‹¤ì‹œê°„ ë©”ì‹ ì €</h3>
  <button class="talk-button" id="goToChat">â–¶ Talk</button>

  <script>
    const userId = "loginUser";
    const crewId = window.location.pathname.split('/').pop();

    // ëŸ¬ë‹ ì‹œê°„ í‘œì‹œ
    fetch(/api/runs / user / ${ userId } / time)

      .then(res => res.json())
      .then(data => {
        const startTime = new Date(data.startTime);
        setInterval(() => {
          const now = new Date();
          const diff = new Date(now - startTime);
          const min = String(diff.getMinutes()).padStart(2, '0');
          const sec = String(diff.getSeconds()).padStart(2, '0');
          document.getElementById('currentRunningTime').textContent = ${ min }:${ sec };
        }, 1000);
      });

    // í•´ë‹¹ í¬ë£¨ ë©¤ë²„ ëŸ¬ë‹ ì‹œê°„ ë¶ˆëŸ¬ì˜¤ê¸°
    fetch(/api/runs / crew / ${ crewId })
      .then(res => res.json())
      .then(members => {
        const list = document.getElementById('crewMemberList');
        list.innerHTML = '';
        members.forEach(m => {
          const div = document.createElement('div');
          div.className = 'user-card';
          div.innerHTML = <strong>${m.nickname}</strong><span>${m.duration}</span>;
          list.appendChild(div);
        });
      });

    // ì±„íŒ…ë°©ìœ¼ë¡œ ì´ë™
    document.getElementById('goToChat').onclick = () => {
      window.location.href = /chat/crew / ${ crewId };
    };
  </script>
</body>

</html>